<!--<%@ page language="java" import="java.util.*" pageEncoding="UTF-8" contentType="text/html; charset=UTF-8"%>-->
<!--<%-->
<!--String path = request.getContextPath();-->
<!--%>-->

<html>
<head>

    <style type="text/css">
        div.build {
            height: 400px;
            width: 400px;
            background-color: #ffffff;
            border: 1px solid black;
            float: right;
            filter:alpha(opacity=80);
            opacity:0.8;
        }
        div.upload {
            height: 400px;
            width: 400px;
            background-color: #ffffff;
            border: 1px solid black;
            float: left;
            filter:alpha(opacity=80);
            opacity:0.8;
        }
        body {
            background-image: url('/image/milkyWay.jpg');
            font-family: "Times New Roman", Georgia, Serif;
            font-weight: bold;
        }
    </style>

    <title>Clara-Deploy</title>
    <meta charset="UTF-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <link rel="stylesheet" href="uploadify/uploadify.css" type="text/css"/>
    <script type="text/javascript" src="uploadify/jquery-3.0.0.js"></script>
    <script type="text/javascript" src="uploadify/jquery.uploadify.js"></script>
    <script type="text/javascript" src="uploadify/swfobject.js"></script>
    <script type="text/javascript">

        function UploadFile() {
            //校验
            var userName = $('#userName').val();
            if (userName.replace(/\s/g, '') == '') {
                alert("username can't be null");
                return false;
            }

            var moduleName = $('#moduleName').val();
            if (moduleName.replace(/\s/g, '') == '') {
                alert("module can't be null");
                return false;
            }
            var warehouse = new Array();

            if ($('#gz').is(':checked')) {
                warehouse.push('gz');
            }
            if ($('#guan').is(':checked')) {
                warehouse.push('guan');
            }
            if ($('#sh').is(':checked')) {
                warehouse.push('sh');
            }
            if (warehouse.length == 0) {
                alert("warehouse can't be null");
                return false;
            }
            $("#fileupload").uploadify('upload', '*');

        }

        $(function () {
            $("#fileupload").uploadify({
                'height': 27,
                'width': 80,
                'buttonText': 'file',
                'swf': '/uploadify/uploadify.swf',
                'uploader': '/UploadAction',
                //'cancelImg' : '/uploadify/uploadify-cancel.png',
                'auto': false,
                'multi': true,
                'queueSizeLimit': 10,
                'simUploadLimit': 10,
                'onUploadStart': function (file) {

                    var warehouse = new Array();

                    if ($('#gz').is(':checked')) {
                        warehouse.push('gz');
                    }
                    if ($('#guan').is(':checked')) {
                        warehouse.push('guan');
                    }
                    if ($('#sh').is(':checked')) {
                        warehouse.push('sh');
                    }

                    $("#fileupload").uploadify("settings", "formData", {
                        'userName': $('#userName').val(),
                        'description': $('#description').val(),
                        'moduleName': $('#moduleName').val(),
                        'warehouse': warehouse
                    });
                },
                'onCancel': function (event, queueID, fileObj) {
                    //alert('The file ' + file.name + '--' + file.size + ' was cancelled.');
                },
                //上传成功
                'onUploadSuccess': function (file, data, response) {
                    if (response == 'true') {
                        alert("success");
                    } else {
                        alert("failed");
                    }

                },
                //上传错误
                'onUploadError': function (file, errorCode, errorMsg, errorString) {
                    alert("failed");
                }
            });
        });

    </script>
</head>


<body>
<div class="upload">
    <p>
        <br>选择库房</br>
        <input type="checkbox" name="gz" id="gz"/> 广州
        <input type="checkbox" name="guan" id="guan"/> 固安
        <input type="checkbox" name="sh" id="sh"/> 上海
    </p>
    <p>
        <br>选择模块</br>
        <select name="moduleName" id="moduleName">
            <option value="receiving">receiving</option>
            <option value="check">check</option>
            <option value="wave">wave</option>
            <option value="master">master</option>
        </select>
    </p>

    <br>
    用户名: <input type="text" id="userName" name="userName">
    </br>
    <p>
        <br>更新内容(多条换行即可):</br>
        <textarea name="description" cols=40 rows=4></textarea></p>
    <p>
        <input type="file" name="uploadify" id="fileupload"/>
        <input type="button" onclick="UploadFile()" value="上传"/>
    </p>
</div>


<div class="build">
    <form action="ReleaseAction" method="POST">
        <br>选择要打包的库房:</br>
        <input type="checkbox" name="gz" id="gzRelease"/> 广州
        <input type="checkbox" name="guan" id="guanRelease"/> 固安
        <input type="checkbox" name="sh" id="shRelease"/> 上海

        <input type="submit" value="生成新版本"/>
    </form>
</div>

</body>
</html>
